Directory Manipulation Routines
Numeric String Evaluation Routines
Byte-Oriented File Input/Output Routines
CP/M File Input/Output Routines
User/Disk Manipulation Routines
File Name String Parser (FNAME) and FCB Init (INITFCB)
ZCPR2-Specific File Name String Parser (ZFNAME) and Support
ZCPR2 Feature-Specific Routines
Input Line Editors
String Output Routines
Numeriã Outpuô Routineó
String and Value Comparison Routines
Character-Oriented Input/Output Routines
Math Routines
CRC Routines
Random Number Generator Routines
Sort Routines
Misãellaneous Routines
::SYSLIB1.HLP
::SYSLIB2.HLP
::SYSLIB3.HLP
::SYSLIB4.HLP
:User/Disk Manipulation Routines

     Thió  ió  á  seô oæ fouò routineó whicè allo÷  thå  useò  tï 
readilù movå arounä betweeî diskó anä useò areas®  Theså routineó 
are:
          PUTUD -- to save away the current disk/user
          GETUD -- to restore the disk/user saved by PUTUD
          RETUD -- to return the current disk/user
          LOGUD -- to log the user into a specified disk/user

     PUTUÄ  anä GETUÄ arå designeä tï bå useä aó á  placå  markeò 
anä  returî  combination®   Theù arå intendeä tï bå useä iî  codå 
sequences like the following:

          CALL PUTUD     ; Mark current location
          < move around on disks/users >
          CALL GETUD     ; Return to marked location

     RETUÄ anä LOGUÄ arå tï bå useä tï finä ouô wherå thå prograí 
is (RETUD) and to enter a specific disk/user area (LOGUD).

     Routine Name:  PUTUD
     Functionº
          PUTUÄ  saveó thå currenô useò anä disë numberó awaù foò 
lateò  retrievaì bù GETUD®   PUTUÄ anä GETUÄ arå intendeä  tï  bå 
useä  tï  savå anä restorå thå currenô disë anä useò arounä  somå 
set of operations in another user/disk area.
     Inputs:  None
     Outputs:  None
     Registers Affected:  None
     SYSLIB Routines Called:  RETUD
     Speciaì  Erroò Conditionsº  None


     Routine Name:  GETUD
     Functionº
          GETUÄ  restoreó  thå currenô useò anä  disë  whicè  waó 
saved by PUTUD.
     Inputs:  None
     Outputs:  None
     Registers Affected:  None
     SYSLIB Routines Called:  BDOS
     Speciaì  Erroò Conditionsº  None


     Routine Name:  LOGUD
     Functionº
          LOGUÄ logó iî thå disë specifieä bù thå Â registeò (B=° 
foò Disë A) and the user specified by the C register.
     Inputs:  B=Disk (B=0 for Disk A), C=User
     Outputs:  None
     Registers Affected:  None
     SYSLIB Routines Called:  BDOS
     Speciaì  Erroò Conditionsº  None


     Routine Name:  RETUD
     Functionº
          RETUÄ  returnó thå numberó oæ thå currenô useò iî Ã anä 
current disk in B (B=0 for disk A).
     Inputs:  None
     Outputs:  B=Disk (B=0 for disk A), C=User
     Registers Affected:  BC
     SYSLIB Routines Called:  BDOS
     Speciaì  Erroò Conditionsº  None


:File Name String Parser (FNAME) and FCB Init (INITFCB)
     Routine Name: FNAME
     Function:
          FNAMÅ  ió á filå namå scanner®   Pointinç tï thå  firsô 
characteò oæ á filå namå specificatioî oæ thå form:

               du:filename.typ

wherå  anù  parô oæ thå specificatioî ió optional¬  thió  routinå 
filló iî aî FCÂ witè zeroeó (3¶ bytes)¬  properlù initializeó thå 
FÎ (Filå Name© fielä iæ 'filename§ ió presenô anä FÔ (Filå  Type© 
fielä iæ 'typ§ ió present¬ anä returnó thå numbeò oæ thå selecteä 
disë  (iî  thå rangå froí ± foò Á tï 1¶ foò P© iæ 'd§ ió  presenô 
anä  thå numbeò oæ thå selecteä useò (iî thå rangå froí °  tï  3± 
anä  thå questioî marë '?§ character© iæ 'u§ ió present®   Iæ 'd§ 
ió noô present¬ 0FFÈ ió returneä foò iô tï indicatå currenô disk¬ 
anä  iæ 'u§ ió noô present¬  0FFÈ ió returneä foò iô tï  indicatå 
currenô user.


     Thå strinç pointeä tï bù HÌ ió noô á conventionaì strinç  iî 
thå  senså  oæ thå resô oæ thå SYSLIÂ routines®   Thió strinç  ió 
terminateä bù anù oæ thå followinç delims¬  aó opposeä bù  simplù 
alwayó beinç terminateä bù á binarù zero®  Thå delimiteò lisô is:

               <NULL or Binary 0>       <SP or Space>
               =    _    ;    ,    <    >

     Thå followinç arå valiä examples:
               test.txt   <-- FN=TEXT  FT=TXT, B reg = 0FFH,
                              C reg = 0FFH
               a:t        <-- FN=T  FT=<SP>, B reg = 1,
                              C reg = 0FFH
               5:t        <-- FN=T  FT=<SP>, B reg = 0FFH,
                              C reg = 5
               c10:x.y    <-- FN=X  FT=Y, B reg = 3,
                              C reg = 10


     Inputs:  HL points to the first byte of the target string
                    (which ends in a delimiter)
              DE pts to the first byte of a 36-byte long FCB
     Outputs:  B=Disk Number (1 for A to 16 for P, or 0FFH if
                    no disk specified)
               C=User Number (0 to 31 or '?' for all users, or
                    0FFH if no user specified)
               HL points to the character which ended the scan
               A = 0 and Zero Flag Set (Z) if invalid Disk or User
                    Specified; A = 0FFH and NZ if no error
     Registers Affected: PSW, BC, HL
     SYSLIB Routines Called:  CAPS
     Special Error Conditions:  None


     Routine Name:  INITFCB
     Functionº
          INITFCÂ  simplù  clearó alì oæ thå fieldó oæ á  36-bytå 
     FCÂ  tï  zerï excepô foò thå FÎ anä FÔ (Filå Namå  anä  Filå 
     Type© fields¬ whicè iô leaveó untouched.

     Inputs:  DE = pointer to FCB buffer
     Outputs:  None
     Registers Affected:  None
     SYSLIB Routines Called:  FILLB
     Special Error Conditions:  None
::SYSLIB8.HLP
::SYSLIB9.HLP
::SYSLIBA.HLP
:String Output Routines -- PRINT, LPRINT, PSTR, LPSTR
     Routine Names:  PRINT, LPRINT
     Functionº
          Prinô  strinç pointeä tï bù thå returî addresó oî  CONº 
(PRINT©  oò LSTº  (LPRINT)®   Strinç ió terminateä bù á binarù 0®  
Controì ió returneä tï bytå followinç string.
     Inputs:  Return Address = pointer to string to be printed
     Outputs:  HL points to byte after string
               (string is printed on CON: or LST:)
     Registers Affected:  HL
     SYSLIB Routines Called:  PSTR (for PRINT); LSTR (for LPRINT)
     Speciaì Erroò Conditions:
          Thå strinç MUSÔ bå terminateä bù á binarù 0!!!

     Routine Names:  PSTR, LPSTR
     Functionº
          Prinô  strinç pointeä tï bù HÌ oî CONº  (PSTR© oò  LSTº 
(LPSTR)®  Strinç ió terminateä bù á binarù 0.
     Inputs:  HL = pointer to string to be printed
     Outputs:  HL pts to the byte following the terminating 0
                (string is printed on CON: or LST:)
     Registers Affected:  HL
     SYSLIÂ  Routineó Calledº  CCOUT¬  COUÔ (foò PSTR)»
                               LCOUT¬ LOUÔ (foò LPSTR)
     Speciaì Erroò Conditions:
          Thå strinç MUSÔ bå terminateä bù á binarù 0!!!
::SYSLIB5.HLP
:String and Value Comparision Routines
     Routine Name:  COMPHD
     Functionº
          Comparå HÌ tï DE®   Oî return¬  Zerï Flaç Seô =¾ HL=DE¬ 
Carrù Flaç Seô =¾ HL<DE.
     Inputs:  HL, DE -- Values to compare
     Outputs:  Zero and Carry Flags
     Registers Affected:  PSW
     SYSLIB Routines Called:  -None-
     Special Error Conditions:  -None-

     Routine Names:  COMPB, COMPBC
     Functionº
          Vectoò Comparå Routines®  Comparå thå vectoò pointeä tï 
bù  HÌ witè thaô pointeä tï bù DÅ (Vectoró arå oæ equaì  length)®  
Vectoró  arå Â byteó lonç foò COMPÂ anä BÃ byteó lonç foò COMPBC®  
Oî  exit¬  Zerï  Flaç Seô indicateó thaô vectoró  arå  identical» 
Carrù Flaç Seô indicateó thaô thå vectoò pointeä tï bù HÌ ió lesó 
thaî thå vectoò pointeä tï bù DE.
     Inputs:  HL, DE -- Pointers to vectors to compare
              B (for COMPB), BC (for COMPBC) -- number of bytes in vectors
     Outputs:  Zero and Carry Flags
     Registers Affected:  PSW
     SYSLIB Routines Called:  -None-
     Special Error Conditions:  -None-

     Routine Name:  SCANNER
     Functionº
          SCANNEÒ scanó thå vectoò oæ byteó pointeä tï bù HÌ  foò 
thå  vectoò oæ byteó pointeä tï bù DE®   Thå HL-bytå vectoò ió  Â 
byteó lonç anä thå DE-bytå vectoò ió Ã byteó long®  Oî return¬ iæ 
found¬ HÌ pointó tï thå beginninç locatioî withiî thå originaì HÌ 
vectoò  oæ  thå locateä vectoò anä thå Zerï Flaç ió Set»  iæ  noô 
found¬ Zerï Flaç ió noô seô anä HÌ ió noô affecteä (pointó tï thå 
beginninç oæ thå originaì HL-bytå vector).
     Inputs:  HL = Pointer to vector to be scanned
              DE = Pointer to vector to scan for
              B = Number of bytes in HL-vector
              C = Number of bytes in DE-vector
     Outputs:  If found, Zero Set and HL pts to located vector
               If not found, Zero Reset and HL unaffected
     Registers Affected:  PSW, HL
     SYSLIB Routines Called:  -None-
     Speciaì  Erroò  Conditionsº   Automatiã  succesó  iæ  vectoò 
searcheä foò ió null.

     Routine Name:  INSTR
     Functionº
          INSTRINÇ  Function®   Scaî thå strinç pointeä tï bù  HÌ 
foò thå strinç pointeä tï bù DE®   Á strinç ió á vectoò oæ  byteó 
terminateä bù á binarù 0.
          Oî return¬  iæ found¬ Zerï Flaç ió Seô anä HÌ pointó tï 
1sô bytå oæ substrinç withiî scanneä string»  iæ noô found¬  Zerï 
Flaç ió noô seô anä HÌ ió noô affected.
     Inputs:  HL = Pointer to string to be scanned
              DE = Pointer to string to scan for
     Outputs:  If found, Zero Set and HL pts to located substring
               If not found, Zero Reset and HL unaffected
     Registers Affected:  PSW, HL
     SYSLIB Routines Called:  -None-
     Speciaì Erroò Conditions:
          Automatiã succesó iæ strinç searcheä foò ió null.
::SYSLIB6.HLP
::SYSLIB7.HLP
:CRC Routines -- CRCCLR, CRCUPD, CRCDONE, CRC1's, CRC2's
     Thå  CRÃ  Routineó maù bå useä tï checë thå validitù  oæ  aî 
incominç seriaì bytå streaí oæ arbitrarù length®   Theså routineó 
computå anä checë á truå 16-biô Cycliã Redundancù Codå (CRC).
     The use of these routines will guarantee detection of:
          1) all single- and double-bit errors
          2) all errors with an odd number of error bits
          3) all burst errors of length 16 or less
     Additionally, the following statistics:
          1) 99.9969% of all 17-bit error bursts
          2) 99.9984% of all possible longer error bursts

     Thå  followinç  screeî displaù illustrateó á typicaì waù  tï 
uså theså routines:

     CRC$MAKE:                ; ROUTINE TO ESTABLISH OUTGOING CRC VALUE
          CALL CRCCLR    ; CLEAR CRC
          <loop CALLing CRCUPD>    ; ACQUIRE VALUES
          CALL CRCDONE   ; GET VALUE
          SHLD CRCVAL    ; SAVE VALUE
     CRC$CHECK:          ; ROUTINE TO CHECK INCOMING CRC VALUE
          CALL CRCCLR    ; CLEAR CRC
          <loop CALLing CRCUPD>    ; ACQUIRE VALUES
          CALL CRCDONE   ; GET VALUE
          XCHG           ; VALUE IN DE
          LHLD CRCVAL    ; GET FIRST VALUE IN HL
          CALL COMPHD    ; COMPARE HL TO DE
          JNZ  ERROR     ; CRC'S DON'T MATCH IF NOT EQUAL

     Thå  followinç  screeî displayó describå thå  CRÃ  routines®  
Thå  CRC- routineó uså thå X^16+X^12+X^5+± polynomial¬  thå CRC1- 
routineó  uså  thå  X^16+X^15+X^2+±  polynomial¬  anä  thå  CRC2-
routines use the X^16+X^15+X^13+X^7+X^4+X^2+X+1 polynomial.
     Routine Name:  CRCCLR, CRC1CLR, CRC2CLR
     Functionº
          Cleaò  thå  internaì CRÃ Accumulatoò iî preparatioî  tï 
CRÃ computation.
     Inputs:  None
     Outputs:  None
     Registers Affected:  None
     SYSLIB Routines Called:  None
     Special Error Conditions:  None

     Routine Name:  CRCUPD, CRC1UPD, CRC2UPD
     Function:
          Updatå thå CRÃ Accumulatoò valuå witè thå nexô byte.
     Input:  A=byte to be included in CRC
     Outputs:  None
     Registers Affected:  None
     SYSLIB Routines Called:  None
     Special Error Conditions:  None
     Routine Name:  CRCDONE, CRC1DONE, CRC2DONE
     Functionº
          Terminatå   CRÃ  valuå  accumulatioî  anä  returî   thå 
calculateä 16-biô CRÃ value.
     Inputs:  None
     Output:  HL = calculated CRC value
     Registers Affected:  HL
     SYSLIB Routines Called:  None
     Special Error Conditions:  None

:Random Number Generator Routines

     The Random Number Generator Routines are:

          RNDINIT - Initializes the Generator Seed on user
                         keypress
          RNDSEED - Allows user to provide a seed
          RND - Returns a Pseudo-Random Number


     Routine Name:  RNDINIT
     Functionº
          RNDINIÔ enteró á countinç loop¬ waitinç foò thå useò tï 
strikå á keù aô hió console®  Iô theî setó thå seeä valuå foò thå 
randoí numbeò generatoò baseä upoî itó counô valuå aô thå instanô 
of keypress.  The seed value is an 8-bit quantity.
     Inputs:  None (User Keypress)
     Outputs:  None  (Seed is set)
     Registers Affected:  None
     SYSLIB Routines Called:  CONDIN, RND
     Speciaì  Erroò Conditionsº  None

     Routine Name:  RNDSEED
     Functionº
          Thió  routinå  allowó thå useò tï providå á seeä  valuå 
foò  thå randoí numbeò generator®   Thå seeä ió passeä iî  thå  Á 
register.
     Inputs:  A = Seed
     Outputs:  None  (Seed is set)
     Registers Affected:  None
     SYSLIB Routines Called:  RND
     Speciaì  Erroò Conditionsº  None


     Routine Name:  RND
     Functionº
          Thió ió thå user-callablå randoí numbeò generator®   Iô 
returnó  á  pseudo-randoí numbeò (8-bit© iî thå Á  registeò  wheî 
called.
     Inputs:  None
     Outputs:  A = Random Number
     Registers Affected:  PSW
     SYSLIB Routines Called:  None
     Speciaì  Erroò Conditionsº  None

::SYSLIBB.HLP
::SYSLIBC.HLP
